(require lispy.macros *)
(from functools [reduce])

(def sol [lst]
  (= d-num 1)
  (= l 10)
  (= cur 1)
  (= ret [])
  (for i lst
    (while (< (* d-num (- l (// l 10))) (- i cur))
      (+= cur (* d-num (- l (// l 10))))
      (+= d-num 1)
      (*= l 10))
    (ret.append (int (sub (str (+ (// l 10) (// (- i cur) d-num))) (% (- i cur) d-num)))))
  (return (reduce (lambda [x y] (* x y)) ret)))

(print (sol [(** 10 i) for i in (range 7)]))
